# LSTM-and-2D-CNN-from-Electrocardiogram
[심전도를 이용한 LSTM과 2D-CNN의 앙상블기반 개인식별](https://220.67.200.233/handle/2020.oak/19587)

- [1. Introduce](#Introduce)
- [2. Analysis](#Analysis)
- [3. Takeaway](#Takeaway)
- [etc](#etc)

## Introduce
- 심전도 신호 신호를 이용한 `LSTM`, `2D-CNN` 앙상블 기반의 분석 파악
- 심전도 신호 분석 논문
- 생체 인식을 하기 위해서는 7가지 특성 필요 ✔
  1. 모든 사람이 갖고 있는 __보편성__
  2. 고유의 특징을 가지는 __유일성__
  3. __영구성__
  4. 생체정보를 쉽고 간단하게 획득할 수 있는 __획득성__
  5. 정보를 받아들이고 처리하는 속도와 정확도 등이 포함된 __정확성__
  6. 생체 정보의 측정 거부감이 들지 않을 정도의 __접근성__
  7. 부정한 사용에도 안전한지의 __기만성__
- 생체인식 
  - 신체적인 특성(얼굴, 지문, 홍채 등)
  - 행동적인 특징(음성, 걸음걸이, 심전도, 뇌파)
- 신체외부에서 표출되는 생체 정보들은 인식 오류, 위변조 위험이 있다.
  - 이를 해결하기 위해 __신체 내부__ 의 신호를 사용하자 
  - 뇌전도(EEG, electroencephalogram), 근전도(EMG, electromyogram), 심전도(ECG, electrocardiogram) 등을 사용한 연구 활발히 진행
- 해당 논문에서는 심전도 신호의 특징을 추출하기 위해 `Handcrafted` 특징방법 사용 ✔
  - 심전도 신호의 진폭
  - 시간 간격(ST간격, PQ간격, QS간격)
  - 피크(P, Q, R, S, T 최소 피크와 최대 피크) 
  - 각도 등...
- `Handcrafted` 특징방법 ✔
  - 머신러닝 속함
  - 직접 특징을 추출하고 이를 기반으로 학습하는 방식(심전도 신호의 피크를 감지하는 것이 __신호의 가변성__ 이 높기 때문에 문제 발생 ㅠ,ㅠ)
  - 잡음 제거 또는 특징 추출하는 과정에서 성능 저하 문제 발생 
- 위와 같은 문제를 해결하고자
  - __시계열__ 의 성능을 향상시키는 `LSTM` 
  - 이미지 분류 성능이 뛰어난 `2D-CNN` 
- 딥러닝은 학습을 통해 특징을 추출하기에 `Handcrafted` 특징방법과 같이 직접 추출 필요 ❌
- `Non-Handcrafted Fiducial` 특징방법은 심전도 신호의 전반적인 형태를 기반으로 특성 점을 사용하지 않기 때문에 신호 분할을 위해 `R-피크` 검출 필요
- 따라서, 본 논문에서는 심전도 신호를 `Non-Handcrafted Fiducial` 특징방법을 사용하기 위해
  - 잡음 제거된 신호를 `R-피크` 검출하여 일정한 간격으로 분할 진행
  - 분할된 신호 >> 딥러닝 모델인 `LSTM`, `2D-CNN` 통해 시계여로가 이미지의 성능 향상 기대
  - 두 모델을 결합하는 제안된 앙상블 방법을 사용해 더 높은 성능!
## Analysis
- 심전도(ECG) 이용한 __장단기 메모리__ , __합성곱 신경망의 앙상블기반__ 으로 개인식별
### 심전도 신호의 전처리 방법 ✔
- 심전도 신호는 미세한 전류를 측정하는 생체 신호 >> 다양한 잡음들이 심전도 신호보다 크게 나타나는 경우 존재 / `전처리 과정` 필요
- 심박수의 가변성의 영향을 줄이기 위해 >> `진폭 정규화 과정` 필요
- 심전도 신호 잡음 제거
  - 주파수 필터
  - 평균 이동 필터 >> 미세한 잡음 제거
  - 노치 필터 >> 특정 범위의 주파수 영역 제거하는 필터
  - 칼만 필터 
  - 베이지안 필터
  - 저역 필터, 고역 통과 필터 >> 심장 질환의 정보를 포함한 심전도 신호 왜곡된 결과 초래 ㅠ,ㅠ
- 평균 이동 필터 적용한 신호
  ![image](https://user-images.githubusercontent.com/61215550/164885836-90bb615c-fdc0-4d40-b528-0696e0a6cace.png)
### 심전도기반 딥러닝을 이용한 개인식별 ✔
- 심전도 이용한 개인 사용자 인식 관련 연구 `Biel`에 의해 최초 연구 ⭐
- 기존에는 머신러닝에 속하는 `Handcrafted` 특징방법을 사용 ✔

|연구자|설명|
|-----|-----|
|`Israel`|심전도 이용해 개인을 식별하기 위해 `P, R, S` 피크 기반으로 최대 로컬 값을 찾고 경사를 추적하여 최소 곡률 반경의 위치를 찾아 시간 간격 특징으로 `15`개의 특징 추출|
|`Jahiruzzaman`|웨이블릿 변환<br>- 이미지 압축, 패턴인식 등과 같은 신호처리에 사용되어 시간 영역의 표현을호 특징 추출을 위해 `CWT(Continuous Wavelet Transform)` 사용<br> `MIT-BIH` 부정맥 DB 사용해 `ECG` 신호에 __CWT__ 통해 암호화 기술 적용하여 ID 매칭 사용해 개인 식별 진행|
|`Zhao`|앙상블 경험적 모드 분해(`EEMD`, Ensemble Empirical Mode Decomposition)과 웰치 스펙트럼 분석을 사용하여 `IMFS(Intrinsic Mode Function Spectral)` 특징 추출하여 신호의 형태학적 정보, 스펙트럼 정보를 추출하기 위해 사용|
|`Labati`|PTB 데이터베이스를 사용해 CNN기반 Deep-ECG를 제안하여 전처리, CNN 특징추출, 식별 순으로 진행 <BR>전처리 과정에서 노치 필터, IIR 필터, 3차 고역 통과가 사용되고 <BR> CNN은 6개의 컨볼루션 게층, 드롭아웃 계층 1개, 완전 연결 계층과 소프트맥스 계층으로 구성되 개인식별 진행|
|`Abdeldayem`|심전도 이용해 개인식별하기 위해 5가지 접근 방법 제시<br> 1. 심전도 신호의 주기적인 특징을 사용해 신호 구별<br> 2. 심전도 신호의 주기적인 특징을 사용해 신호 구별<br> 3. 잡음은 순환 정지하지 않기 때문에 잡음 제거하는 단계를 사용하지 않는 것<br> 4. 신호의 주파수 영역인 파워 스펙트럼 밀도로 변환해 `2D-CNN`을 사용<BR> 5. 사용한 8개의 공개 DB 를 하나의 데이터로 결합해 사용|
|`Ciocoiu`|심전도 신호를 전처리 과정으로 대역 통과 필터링을 통해 잡음을 제거하고 R피크 중심으로 일정한 시간으로 주기 분할 ...|
- 이외에도 많은 연구자들의 방법들이 존재!

- 하지만!! `Handcrafted` 특징방법은 심전도 신호의 특징을 사람이 __직접 추출__ 하여 학습시키기 때문에 개인식별 성능이 저하되는 문제 발생 ㅠ,ㅠ ✔
- 이와 반대로 __딥러닝__ 은 위와 같은 문제를 해결하고 __자동 추출__ 하여 시계열과 영상, 텍스트 분야에서 분류, 회귀 널리 사용 >> ⭐ 개인식별 연구 활발 

### LSTM과 2D-CNN의 앙상블기반 개인식별 ✔

  
## Takeaway

## etc
### 1. 시계열
- 고급 통계분석방법의 하나
- 일정한 시간 간격으로 표시된 자료의 특성(추세변동, 계절변동, 순환변동, 불규칙변도)을 파악하여 미래를 예측하는 분석방법
- ![image](https://user-images.githubusercontent.com/61215550/164890560-fb299cf7-93d5-45c4-8f93-7f8ce089fd9a.png)

### 2. RNN 순환 신경망
> [참고 자료](https://wikidocs.net/22886)
- 입력과 출력을 시퀀스 단위로 처리하는 시퀀스 모델
  - 입력: 번역하고자 하는 단어의 시퀀스인 문장
  - 출력: 번역된 문장과 단어의 시퀀스
  - 시퀀스 모델: 시퀀스들을 처리하기 위해 고안된 모델들
